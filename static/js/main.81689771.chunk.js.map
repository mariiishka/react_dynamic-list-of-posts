{"version":3,"sources":["contexts/PostsContext.ts","customHooks/usePostsContext.ts","components/PostsList/PostsList.tsx","api/api.ts","api/comments.ts","components/NewCommentForm/NewCommentForm.tsx","api/posts.ts","components/PostDetails/PostDetails.tsx","App.tsx","api/users.ts","index.tsx"],"names":["PostsContext","React","createContext","posts","setPosts","selectedPostId","setSelectedPostId","comments","setComments","usePostsContext","useContext","PostsList","memo","className","length","map","id","userId","title","type","onClick","handleClick","request","endpoint","option","fetch","then","response","json","Error","status","statusText","deleteComment","commentId","method","NewCommentForm","useState","userName","setUserName","userEmail","setUserEmail","userComment","setUserComment","handleChange","event","target","name","value","onSubmit","preventDefault","newComment","headers","body","JSON","stringify","postComment","postId","email","onChange","placeholder","required","getUserPosts","PostDetails","postDetails","setPostDetails","isCommentsVisible","setIsCommentsVisible","loadPostDetails","loadPostComments","useEffect","state","deletedComment","filteredComments","filter","comment","toDeleteComment","App","users","setUsers","loadPosts","loadUsers","data","slice","Promise","all","Provider","Number","user","Boolean","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.81689771.chunk.js","sourcesContent":["import React from 'react';\nimport { Post } from '../types/Post';\nimport { Comment } from '../types/Comment';\n\ntype PostsContextType = {\n  posts: Post[],\n  setPosts: (posts: Post[]) => void,\n  selectedPostId: number,\n  setSelectedPostId: (selectedPostId: number) => void,\n  comments: Comment[],\n  setComments: (comments: Comment[]) => void,\n};\n\nexport const PostsContext = React.createContext<PostsContextType>({\n  posts: [],\n  setPosts: () => {},\n  selectedPostId: 0,\n  setSelectedPostId: () => {},\n  comments: [],\n  setComments: () => {},\n});\n","import { useContext } from 'react';\nimport { PostsContext } from '../contexts/PostsContext';\n\nexport const usePostsContext = () => useContext(PostsContext);\n","import React from 'react';\nimport { usePostsContext } from '../../customHooks/usePostsContext';\nimport './PostsList.scss';\n\nexport const PostsList: React.FC = React.memo(() => {\n  const { posts, selectedPostId, setSelectedPostId } = usePostsContext();\n\n  const handleClick = (id: number) => {\n    if (id === selectedPostId) {\n      setSelectedPostId(0);\n    } else {\n      setSelectedPostId(id);\n    }\n  };\n\n  return (\n    <div className=\"PostsList\">\n      <h2>Posts:</h2>\n\n      <ul className=\"PostsList__list\">\n        {posts.length\n          ? (\n            posts.map(({ id, userId, title }) => (\n              <li key={id} className=\"PostsList__item\">\n                <div>\n                  <b>{`[User #${userId}] `}</b>\n                  {title}\n                </div>\n                <button\n                  type=\"button\"\n                  className=\"PostsList__button button\"\n                  onClick={() => {\n                    handleClick(id);\n                  }}\n                >\n                  {selectedPostId === id ? 'Close' : 'Open'}\n                </button>\n              </li>\n            ))\n          )\n          : 'Not found'}\n      </ul>\n    </div>\n  );\n});\n","export const BASE_URL = 'https://mate.academy/students-api';\n\nexport const request = (endpoint: string, option?:RequestInit) => {\n  return fetch(`${BASE_URL}${endpoint}`, option)\n    .then(response => response.json())\n    .then(response => {\n      if (response.Error) {\n        throw new Error(`${response.status} - ${response.statusText}`);\n      }\n\n      return response;\n    });\n};\n","import { Comment } from '../types/Comment';\nimport { request } from './api';\n\nexport const getPostComments = (postId: number): Promise<Comment[]> => (\n  request(`/comments?postId=${postId}`)\n);\n\nexport const postComment = (newComment: Comment) => (\n  request('/comments', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify(newComment),\n  })\n);\n\nexport const deleteComment = (commentId: number) => (\n  request(`/comments/${commentId}`, {\n    method: 'DELETE',\n  })\n);\n","import React, { useState, ChangeEvent } from 'react';\nimport { postComment } from '../../api/comments';\nimport { usePostsContext } from '../../customHooks/usePostsContext';\nimport './NewCommentForm.scss';\n\ntype ChangeEventHTML = HTMLInputElement | HTMLTextAreaElement;\n\nexport const NewCommentForm: React.FC = React.memo(() => {\n  const { comments, setComments, selectedPostId } = usePostsContext();\n  const [userName, setUserName] = useState('');\n  const [userEmail, setUserEmail] = useState('');\n  const [userComment, setUserComment] = useState('');\n\n  const resetForm = () => {\n    setUserName('');\n    setUserEmail('');\n    setUserComment('');\n  };\n\n  const handleChange = (event: ChangeEvent<ChangeEventHTML>) => {\n    const { name, value } = event.target;\n\n    switch (name) {\n      case 'userName':\n        setUserName(value);\n        break;\n      case 'userEmail':\n        setUserEmail(value);\n        break;\n      case 'userComment':\n        setUserComment(value);\n        break;\n      default:\n        break;\n    }\n  };\n\n  const handleSubmit = (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n\n    const newComment = {\n      postId: selectedPostId,\n      body: userComment,\n      name: userName,\n      email: userEmail,\n    };\n\n    postComment(newComment)\n      .then((response) => {\n        setComments([...comments, response]);\n      });\n    resetForm();\n  };\n\n  return (\n    <form className=\"NewCommentForm\" onSubmit={handleSubmit}>\n      <div className=\"form-field\">\n        <input\n          type=\"text\"\n          name=\"userName\"\n          value={userName}\n          onChange={handleChange}\n          placeholder=\"Your name\"\n          className=\"NewCommentForm__input\"\n          required\n        />\n      </div>\n\n      <div className=\"form-field\">\n        <input\n          type=\"text\"\n          name=\"userEmail\"\n          value={userEmail}\n          onChange={handleChange}\n          placeholder=\"Your email\"\n          className=\"NewCommentForm__input\"\n          required\n        />\n      </div>\n\n      <div className=\"form-field\">\n        <textarea\n          name=\"userComment\"\n          value={userComment}\n          onChange={handleChange}\n          placeholder=\"Type comment here\"\n          className=\"NewCommentForm__input\"\n          required\n        />\n      </div>\n\n      <button\n        type=\"submit\"\n        className=\"NewCommentForm__submit-button button\"\n      >\n        Add a comment\n      </button>\n    </form>\n  );\n});\n","import { Post } from '../types/Post';\nimport { request } from './api';\n\nexport const getAllPosts = () => {\n  return request('/posts');\n};\n\nexport const getUserPosts = (userId?: number): Promise<Post[]> => {\n  if (!userId) {\n    return getAllPosts();\n  }\n\n  return request(`/posts/?userId=${userId}`);\n};\n\nexport const getPostDetails = (postId: number): Promise<Post> => (\n  request(`/posts/${postId}`)\n);\n","import React, { useEffect, useState } from 'react';\nimport { usePostsContext } from '../../customHooks/usePostsContext';\nimport { NewCommentForm } from '../NewCommentForm';\nimport { getPostDetails } from '../../api/posts';\nimport './PostDetails.scss';\nimport { Post } from '../../types/Post';\nimport { deleteComment, getPostComments } from '../../api/comments';\n\nexport const PostDetails: React.FC = React.memo(() => {\n  const { selectedPostId, comments, setComments } = usePostsContext();\n  const [postDetails, setPostDetails] = useState<Post>();\n  const [isCommentsVisible, setIsCommentsVisible] = useState(true);\n\n  const handleClick = () => {\n    setIsCommentsVisible((state) => !state);\n  };\n\n  const loadPostDetails = () => {\n    getPostDetails(selectedPostId)\n      .then(setPostDetails);\n  };\n\n  const loadPostComments = () => {\n    getPostComments(selectedPostId)\n      .then(setComments);\n  };\n\n  const toDeleteComment = (commentId = 0) => {\n    deleteComment(commentId)\n      .then(deletedComment => {\n        if (deletedComment) {\n          const filteredComments = comments.filter(\n            comment => comment.id !== commentId,\n          );\n\n          setComments(filteredComments);\n        }\n      });\n  };\n\n  useEffect(() => {\n    loadPostDetails();\n    loadPostComments();\n  }, [selectedPostId]);\n\n  return (\n    <div className=\"PostDetails\">\n      <h2>Post details:</h2>\n\n      <section className=\"PostDetails__post\">\n        <p>{postDetails?.body}</p>\n      </section>\n\n      {comments.length > 0 && (\n        <section className=\"PostDetails__comments\">\n          <button\n            type=\"button\"\n            className=\"button\"\n            onClick={handleClick}\n          >\n            {isCommentsVisible\n              ? (\n                `Hide ${comments.length} comment(s)`\n              ) : (\n                `Show ${comments.length} comment(s)`\n              )}\n          </button>\n\n          {isCommentsVisible && (\n            <ul className=\"PostDetails__list\">\n              {comments.map(({ id, body }) => (\n                <li key={id} className=\"PostDetails__list-item\">\n                  <button\n                    type=\"button\"\n                    className=\"PostDetails__remove-button button\"\n                    onClick={() => toDeleteComment(id)}\n                  >\n                    X\n                  </button>\n                  <p>{body}</p>\n                </li>\n              ))}\n            </ul>\n          )}\n        </section>\n      )}\n\n      <section>\n        <div className=\"PostDetails__form-wrapper\">\n          <NewCommentForm />\n        </div>\n      </section>\n    </div>\n  );\n});\n","import React, { useEffect, useState } from 'react';\nimport './App.scss';\nimport './styles/general.scss';\nimport { PostsList } from './components/PostsList';\nimport { PostDetails } from './components/PostDetails';\nimport { PostsContext } from './contexts/PostsContext';\nimport { getUserPosts } from './api/posts';\nimport { getUsers } from './api/users';\nimport { User } from './types/User';\nimport { Post } from './types/Post';\nimport { Comment } from './types/Comment';\n\nconst App: React.FC = () => {\n  const [selectedPostId, setSelectedPostId] = useState(0);\n  const [posts, setPosts] = useState<Post[]>([]);\n  const [users, setUsers] = useState<User[]>([]);\n  const [comments, setComments] = useState<Comment[]>([]);\n\n  const loadPosts = (userId?: number) => {\n    getUserPosts(userId)\n      .then(setPosts);\n  };\n\n  const loadUsers = () => {\n    getUsers()\n      .then(data => setUsers(data.slice(0, 8)));\n  };\n\n  useEffect(() => {\n    Promise.all([loadPosts(), loadUsers()]);\n  }, []);\n\n  return (\n    <PostsContext.Provider value={{\n      selectedPostId,\n      setSelectedPostId,\n      posts,\n      setPosts,\n      comments,\n      setComments,\n    }}\n    >\n      <div className=\"App\">\n        <header className=\"App__header\">\n          <label>\n            Select a user: &nbsp;\n\n            <select\n              className=\"App__user-selector\"\n              onChange={(event) => {\n                loadPosts(Number(event.target.value));\n              }}\n            >\n              <option value=\"0\">All users</option>\n              {users.map(user => (\n                <option key={user.id} value={user.id}>\n                  {user.name}\n                </option>\n              ))}\n            </select>\n          </label>\n        </header>\n\n        <main className=\"App__main\">\n          <div className=\"App__sidebar\">\n            <PostsList />\n          </div>\n\n          <div className=\"App__content\">\n            {Boolean(selectedPostId) && <PostDetails />}\n          </div>\n        </main>\n      </div>\n    </PostsContext.Provider>\n  );\n};\n\nexport default App;\n","import { request } from './api';\n\nexport const getUsers = () => request('/users');\n","import ReactDOM from 'react-dom';\n\nimport App from './App';\n\nReactDOM.render(\n  <App />,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}